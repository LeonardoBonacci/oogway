input {
  file {
    path => "C:\logs\oogway\geo.log"
  }
}
filter {
    grok {
        match => {
            "message" => 
				"%{TIMESTAMP_ISO8601:creation}%{SPACE}%{LOGLEVEL}%{SPACE}%{NUMBER}%{SPACE}---%{SPACE}\[(?<thread>[A-Za-z0-9-]+)\] [A-Za-z0-9.]*\.(?<class>[A-Za-z0-9#_]+)%{SPACE}:%{SPACE}%{IPORHOST:clientip}%{SPACE}%{GREEDYDATA:user_input}"
			}
    }
    geoip {
        source => "clientip"
        fields => ["timezone", "latitude", "country_name", "location", "longitude"]
    }
    mutate {
        remove_field => ["@version","thread","class","path","host","message","clientip"]
    }
}
output {
    stdout { 
		codec => rubydebug 
	}
    elasticsearch {
        hosts => [ "localhost:9200" ]
		index => "logstash-spectre"
    }
}